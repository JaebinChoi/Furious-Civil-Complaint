<?xml version="1.0" encoding="UTF-8"?>
<!-- mappers/gueset.xml -->
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- mappers/user.xml -->
<mapper namespace="com.ssafy.repository.SituationRepository"> <!-- mybatis는 namespace필수!! -->

<!--	 올해 제보 정보 전체 조회 
	<select id="selectAll" resultType="Situation">
		select * from situation
		where date like concat('%', #{date}, '%');
	</select> --> 

<!-- 	<select id="selectAll" resultType="Integer">
		SELECT count(*) as count
		FROM violation
		where MONTH(date) = '8';
	</select> -->

	<select id="select0" resultType="Test">
		SELECT a.month, ifnull(b.count,00) as count
		FROM  situationLeftJoin a 
		left JOIN  (SELECT MONTH(date) as month, count(*) as count FROM  violation 
		where YEAR(date) = '2020' and report_status = 0
		GROUP by MONTH(date)) b ON a.month = b.month
		order by a.month;
	</select>
	<select id="select1" resultType="Test">
		SELECT a.month, ifnull(b.count,00) as count
		FROM  situationLeftJoin a 
		left JOIN  (SELECT MONTH(date) as month, count(*) as count FROM  violation 
		where YEAR(date) = '2020' and report_status = 1
		GROUP by MONTH(date)) b ON a.month = b.month
		order by a.month;
	</select>
	<select id="select2" resultType="Test">
		SELECT a.month, ifnull(b.count,00) as count
		FROM  situationLeftJoin a 
		left JOIN  (SELECT MONTH(date) as month, count(*) as count FROM  violation 
		where YEAR(date) = '2020' and report_status = 2
		GROUP by MONTH(date)) b ON a.month = b.month
		order by a.month;
	</select>
	
	
	
	
	
	
	
	<select id="selectByUser0" resultType="Test">
		SELECT a.month, ifnull(b.count,00) as count
		FROM  situationLeftJoin a 
		left JOIN  (SELECT MONTH(date) as month, count(*) as count FROM  violation 
		where YEAR(date) = '2020' and report_status = 0 and user_no = #{userno}
		GROUP by MONTH(date)) b ON a.month = b.month
		order by a.month;
	</select>
		<select id="selectByUser1" resultType="Test">
		SELECT a.month, ifnull(b.count,00) as count
		FROM  situationLeftJoin a 
		left JOIN  (SELECT MONTH(date) as month, count(*) as count FROM  violation 
		where YEAR(date) = '2020' and report_status = 1 and user_no = #{userno}
		GROUP by MONTH(date)) b ON a.month = b.month
		order by a.month;
	</select>
		<select id="selectByUser2" resultType="Test">
		SELECT a.month, ifnull(b.count,00) as count
		FROM  situationLeftJoin a 
		left JOIN  (SELECT MONTH(date) as month, count(*) as count FROM  violation 
		where YEAR(date) = '2020' and report_status = 2 and user_no = #{userno}
		GROUP by MONTH(date)) b ON a.month = b.month
		order by a.month; 
	</select>
	
	
	

</mapper>
